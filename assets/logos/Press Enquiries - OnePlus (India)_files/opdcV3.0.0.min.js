!function(win,doc,undef){var t={h:null};!function(e){"use strict";function t(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,n,o,r,i,a){return t(function(e,t){return e<<t|e>>>32-t}(t(t(n,e),t(r,a)),i),o)}function o(e,t,o,r,i,a,c){return n(t&o|~t&r,e,t,i,a,c)}function r(e,t,o,r,i,a,c){return n(t&r|o&~r,e,t,i,a,c)}function i(e,t,o,r,i,a,c){return n(t^o^r,e,t,i,a,c)}function a(e,t,o,r,i,a,c){return n(o^(t|~r),e,t,i,a,c)}function c(e,n){e[n>>5]|=128<<n%32,e[14+(n+64>>>9<<4)]=n;var c,s,u,d,l,f=1732584193,p=-271733879,m=-1732584194,g=271733878;for(c=0;c<e.length;c+=16)s=f,u=p,d=m,l=g,p=a(p=a(p=a(p=a(p=i(p=i(p=i(p=i(p=r(p=r(p=r(p=r(p=o(p=o(p=o(p=o(p,m=o(m,g=o(g,f=o(f,p,m,g,e[c],7,-680876936),p,m,e[c+1],12,-389564586),f,p,e[c+2],17,606105819),g,f,e[c+3],22,-1044525330),m=o(m,g=o(g,f=o(f,p,m,g,e[c+4],7,-176418897),p,m,e[c+5],12,1200080426),f,p,e[c+6],17,-1473231341),g,f,e[c+7],22,-45705983),m=o(m,g=o(g,f=o(f,p,m,g,e[c+8],7,1770035416),p,m,e[c+9],12,-1958414417),f,p,e[c+10],17,-42063),g,f,e[c+11],22,-1990404162),m=o(m,g=o(g,f=o(f,p,m,g,e[c+12],7,1804603682),p,m,e[c+13],12,-40341101),f,p,e[c+14],17,-1502002290),g,f,e[c+15],22,1236535329),m=r(m,g=r(g,f=r(f,p,m,g,e[c+1],5,-165796510),p,m,e[c+6],9,-1069501632),f,p,e[c+11],14,643717713),g,f,e[c],20,-373897302),m=r(m,g=r(g,f=r(f,p,m,g,e[c+5],5,-701558691),p,m,e[c+10],9,38016083),f,p,e[c+15],14,-660478335),g,f,e[c+4],20,-405537848),m=r(m,g=r(g,f=r(f,p,m,g,e[c+9],5,568446438),p,m,e[c+14],9,-1019803690),f,p,e[c+3],14,-187363961),g,f,e[c+8],20,1163531501),m=r(m,g=r(g,f=r(f,p,m,g,e[c+13],5,-1444681467),p,m,e[c+2],9,-51403784),f,p,e[c+7],14,1735328473),g,f,e[c+12],20,-1926607734),m=i(m,g=i(g,f=i(f,p,m,g,e[c+5],4,-378558),p,m,e[c+8],11,-2022574463),f,p,e[c+11],16,1839030562),g,f,e[c+14],23,-35309556),m=i(m,g=i(g,f=i(f,p,m,g,e[c+1],4,-1530992060),p,m,e[c+4],11,1272893353),f,p,e[c+7],16,-155497632),g,f,e[c+10],23,-1094730640),m=i(m,g=i(g,f=i(f,p,m,g,e[c+13],4,681279174),p,m,e[c],11,-358537222),f,p,e[c+3],16,-722521979),g,f,e[c+6],23,76029189),m=i(m,g=i(g,f=i(f,p,m,g,e[c+9],4,-640364487),p,m,e[c+12],11,-421815835),f,p,e[c+15],16,530742520),g,f,e[c+2],23,-995338651),m=a(m,g=a(g,f=a(f,p,m,g,e[c],6,-198630844),p,m,e[c+7],10,1126891415),f,p,e[c+14],15,-1416354905),g,f,e[c+5],21,-57434055),m=a(m,g=a(g,f=a(f,p,m,g,e[c+12],6,1700485571),p,m,e[c+3],10,-1894986606),f,p,e[c+10],15,-1051523),g,f,e[c+1],21,-2054922799),m=a(m,g=a(g,f=a(f,p,m,g,e[c+8],6,1873313359),p,m,e[c+15],10,-30611744),f,p,e[c+6],15,-1560198380),g,f,e[c+13],21,1309151649),m=a(m,g=a(g,f=a(f,p,m,g,e[c+4],6,-145523070),p,m,e[c+11],10,-1120210379),f,p,e[c+2],15,718787259),g,f,e[c+9],21,-343485551),f=t(f,s),p=t(p,u),m=t(m,d),g=t(g,l);return[f,p,m,g]}function s(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function u(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function d(e){var t,n,o="0123456789abcdef",r="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),r+=o.charAt(t>>>4&15)+o.charAt(15&t);return r}function l(e){return unescape(encodeURIComponent(e))}function f(e){return function(e){return s(c(u(e),8*e.length))}(l(e))}function p(e,t){return function(e,t){var n,o,r=u(e),i=[],a=[];for(i[15]=a[15]=void 0,r.length>16&&(r=c(r,8*e.length)),n=0;16>n;n+=1)i[n]=909522486^r[n],a[n]=1549556828^r[n];return o=c(i.concat(u(t)),512+8*t.length),s(c(a.concat(o),640))}(l(e),l(t))}function m(e,t,n){return t?n?p(t,e):function(e,t){return d(p(e,t))}(t,e):n?f(e):function(e){return d(f(e))}(e)}"function"==typeof define&&define.amd?define(function(){return m}):e.h=m}(t);var createAjax=window.XDomainRequest?function(){return new XDomainRequest}:window.XMLHttpRequest?function(){return new XMLHttpRequest}:window.ActiveXObject?function(){return new ActiveXObject("Microsoft.XMLHTTP")}:void 0,buildParams=function(e,t,n,o){var r;if(n||"object"!=typeof t)o(e,t);else for(r in t)buildParams(e+"["+r+"]",t[r],n,o)},param=function(e,t){var n,o=[],r=function(e,t){var n="function"==typeof t?t():t;o[o.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};for(n in e)buildParams(n,e[n],t,r);return o.join("&")},ajax=function(conf){var url=conf.url,data=conf.data,type=conf.type||"get",headers=conf.headers||{},dataType=conf.dataType||"json",success=conf.success,xhr=createAjax();for(var i in xhr.open(type,url,!0),xhr.withCredentials=!0,headers["X-Requested-With"]||(headers["X-Requested-With"]="XMLHttpRequest"),headers)xhr.setRequestHeader&&xhr.setRequestHeader(i,headers[i]);"GET"==type||"get"==type?xhr.send(null):"POST"!=type&&"post"!=type||(data=object2formdata(data),xhr.setRequestHeader&&xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),xhr.send(data)),xhr.onreadystatechange=function(){if(success&&4==xhr.readyState&&200==xhr.status)if("json"==dataType||"JSON"==dataType){if(null!=success&&xhr.responseText){var obj=JSON&&JSON.parse?JSON.parse(xhr.responseText):eval("("+xhr.responseText+")");success(obj)}}else"text"==dataType||"TEXT"==dataType?null!=success&&success(xhr.responseText):"xml"!=dataType&&"XML"!=dataType||null!=success&&success(xhr.responseXML)}};function object2formdata(e){var t="";return"object"==typeof e&&(t=param(e)),t=t.replace(/%20/g,"+")}function cleanWhite(e){return e.replace(/\s/gi,"")}function trim(e){return e.replace(/^\s+/,"").replace(/\s+$/,"")}function getRootDomain(){if(!getRootDomain.rootDomain){var e=window.location.hostname.split("."),t=e.length;getRootDomain.rootDomain="."+e[t-2]+"."+e[t-1]}return getRootDomain.rootDomain}function setCookie(e,t,n,o){o=void 0===o?getRootDomain():o,doc.cookie=e+"="+t+";path=/;domain="+o+(n?";expires="+n:"")}function getCookie(e){for(var t,n=cleanWhite(doc.cookie).split(";"),o=0;o<n.length;o++)if((t=n[o].split("=")).length>1&&t[0]==e)return t[1];return""}function clearCookie(e,t){var n=new Date;n.setTime(+n.getTime()-18e5),setCookie(e,"",n.toGMTString(),void 0!==t?t:getRootDomain())}function filterDomain(e,t){var n,o,r;for(n in t)if(t.hasOwnProperty(n))for(o=t[n],r=0;r<=o.length-1;r++)if(-1!=e.indexOf(o[r]))return{domain:n,index:r};return!1}var regUrl=/\/\/(.*?)\//;function getDomainByUrl(e){var t=(e=e||"").match(regUrl);return t?t[1]:""}var staticsDomains=["opstatics.com","oneplus.net","oneplus.cn"];function isStaticsDomain(e){return e=e||"",!!staticsDomains.some&&staticsDomains.some(function(t){return e.indexOf(t)>-1})}function getUrl(){return loc.host+loc.pathname+loc.hash.split("?")[0]}function getLang(){return nav.language||nav.userLanguage||nav.browserLanguage||nav.systemLanguage}function getscreeninfo(){var e=win.screen.width,t=win.screen.height;return isMoblie&&e!=win.innerWidth&&win.devicePixelRatio&&(e=win.innerWidth,t/=win.devicePixelRatio),e+"*"+t}function getOpServerTime(e){var t=getCookie("opsertime");return 12===t.length?t*=10:11===t.length?t*=100:10===t.length&&(t*=1e3),t||(t=e),t}function getTimezone(){return(new Date).getTimezoneOffset()/-60}function getUserId(){return getCookie("opuserid")||getCookie("user_id")||getCookie("_sscid")||0}function getAccessType(){var e=win.performance;return e&&e.navigation?e.navigation.type:""}function guess(){return Math.round(2147483647*Math.random())}function getParams(e,n){var o=+new Date,r=new Date;r.setTime(o+18e5),r=r.toGMTString();var i=new Date;i.setTime(o+31536e6),i=i.toGMTString(),function(){var e=loc.host.split(".");if(!(e.length<=2)){var t=e[0]+"_clear";if(!getCookie(t)&&(getCookie("opsid")||getCookie("opcid"))){setCookie(t,"1",i,"");for(var n=["opcid","opcct","oppt","opsid","opsct","opbct","optime_browser","opnt","opstep","opstep_event"],o=0,r=n.length;o<r;o++)clearCookie(n[o],"")}}}();var a,c,s,u,d=getCookie("opsid"),l=getCookie("opcid"),f=getCookie("oppt"),p=getOpServerTime(o);s=p||o,"Access"==e?(l||(setCookie("opcid",l=o+"_"+guess().toString(),i),setCookie("opcct",s,i)),d&&"oneplus"==f?(a=getCookie("opsct")||d.split("_")[0],c=getCookie("opnt")||d.split("_")[0],u=+getCookie("opstep")+1):(d=s+"_"+guess().toString(),setCookie("oppt","oneplus"),a=s,c=s,u=1),setCookie("opsid",d,r),setCookie("opsct",a,i),setCookie("opbct",c,i),setCookie("optime_browser",o,i),setCookie("opnt",s,i),setCookie("opstep",u,i),setCookie("opstep_event",0,i)):"Click"==e&&(a=getCookie("opsct"),c=getCookie("opbct"),s=o-getCookie("optime_browser")+parseInt(p),setCookie("opstep_event",u=+getCookie("opstep_event")+1,i));var m={productId:wid,platform:plat,userId:getUserId(),sessionId:d,cookieId:l,cookieCreateTime:getCookie("opcct"),sesssionCreateTime:a,step:u,url:encodeURIComponent(getUrl()),paramFrom:encodeURIComponent(loc.search),urlFrom:encodeURIComponent(referrer),eventName:e,screenSize:getscreeninfo(),language:getLang(),userAgent:nav.userAgent,os:encodeURIComponent(nav.platform),description:n&&n.description||"",title:doc.title,loginType:getCookie("lty"),timeZone:getTimezone(),lastAccessTime:c,accessTime:s,clientTime:o,accessType:getAccessType()};if(m.requestHash=t.h(m.clientTime+"oneplus"),n&&"object"==typeof n)for(var g in n)n.hasOwnProperty(g)&&(m[g]=n[g]);var h,v=eventMap[e];if("*"!=v&&v.length){h={};for(var w,k=0,T=v.length;k<T;k++)h[w=v[k]]=m[w]}return h||m}function isFunction(e){return"function"==typeof e}function sendData(e,t){report(reportUrl,getParams(e,t))}function report(e,t){win.navigator.sendBeacon?(t.sendBeacon=1,t=object2formdata(t),t=new Blob([t],{type:"application/x-www-form-urlencoded; charset=UTF-8"}),win.navigator.sendBeacon(e,t)):ajax({url:e,type:"POST",data:t})}var domain=doc.domain,nav=win.navigator,referrer=doc.referrer,loc=win.location,domainObj={cn:["oneplusbbs.com","h2os.com","oneplus.cn"],net:["oneplus.net"],com:["oneplus.com","oneplus.in"]},siteArray=["bbs","h2os"],fromFlag=getCookie("analytics_from_flag"),wid,plat,isMoblie,protocol=loc.protocol,browser=nav.userAgent.toLowerCase(),reportUrl,domainInfo,eventMap={Click:"*",Access:"*",Loadtime:["eventName","ttfb","dns","loadTime","productId","platform","screenSize","url","userAgent","os","language","clientTime","requestHash"],JsError:["eventName","stackMsg","errMsg","filename","lineno","promiseErr","productId","platform","screenSize","url","userAgent","os","language","clientTime","requestHash"],ResourceSlow:["eventName","filename","resourceType","dns","loadTime","productId","platform","screenSize","url","userAgent","os","language","clientTime","requestHash"],ResourceError:["eventName","filename","productId","platform","screenSize","url","userAgent","os","language","clientTime","requestHash"]};if(domainInfo=filterDomain(domain,domainObj),!1===domainInfo)return!1;function canUseTiming(){return"object"==typeof win.performance&&win.performance.timing}function sendPageTime(){function e(){window.setTimeout(function(){var e=window.performance.timing;e.loadEventEnd>0&&(sendData("Loadtime",{ttfb:e.responseStart-e.navigationStart,dns:e.domainLookupEnd-e.domainLookupStart,loadTime:e.loadEventEnd-e.navigationStart}),luckyCall(checkResourceLoad,.05))},0)}win.addEventListener?win.addEventListener("load",e):win.attachEvent&&win.attachEvent("load",e)}function clickEventInit(){function e(e){var t=function e(t,n){if(!t)return!1;n=n||2;var o=t.nodeName.toLocaleLowerCase();return function(e){var t=["a","button"],n=e.nodeName.toLocaleLowerCase(),o=e.getAttribute("class");return(t.indexOf&&t.indexOf(n)>-1||function(e,t){for(var n=0,o=t.length;n<o;n++)if(t[n].name===e)return!0;return!1}("track-data",e.attributes)||o&&function(e,t){for(var n=0,o=t.length;n<o;n++)if(e.indexOf(t[n])>-1)return!0;return!1}(o,["btn","button","tab"]))&&e}(t)?t:"body"!=o&&0!==n&&e(t.parentNode,--n)}(e.target);if(t){var n=t.getAttribute("onclick");if(!(n&&n.indexOf("_opq.push")>-1)){var o=t.getAttribute("track-data")||t.getAttribute("title"),r=t.innerText||t.textContent||t.text||t.outerHTML,i=trim(o||r||"");sendData("Click",{domPath:function(e){for(var t=[];e&&e.nodeName&&"body"!=e.nodeName.toLocaleLowerCase();)t.unshift(e.nodeName.toLocaleLowerCase()),e=e.parentNode;return t.join(" > ")}(t),description:i})}}}doc.addEventListener?doc.addEventListener("click",e):doc.attachEvent&&doc.attachEvent("click",e)}function luckyCall(e,t){"function"==typeof e&&(t=t||.5,Math.random()<t&&e())}function checkResourceLoad(){if(win.performance){var e,t,n,o=win.performance.getEntriesByType("resource");for(n in o)"beacon"!=(e=o[n]).initiatorType&&isStaticsDomain(getDomainByUrl(e.name))&&(t={dns:e.domainLookupEnd-e.domainLookupStart,loadTime:win.parseInt(e.duration),resourceType:e.initiatorType,filename:e.name}).loadTime>0&&sendData("ResourceSlow",t)}}fromFlag.indexOf("prod_")>-1?wid=fromFlag:(fromFlag.indexOf("plat_")>-1||fromFlag.indexOf("app_")>-1)&&(plat=fromFlag),window.analytics_from_flag&&(wid=window.analytics_from_flag),wid||(wid="cn"==domainInfo.domain&&siteArray[domainInfo.index]?siteArray[domainInfo.index]:"shop"),plat||(browser.indexOf("iphone")>-1||browser.indexOf("ipad")>-1||browser.indexOf("android")>-1||browser.indexOf("mobile")>-1?(isMoblie=!0,plat="mobile"):plat="pc"),reportUrl="cn"==domainInfo.domain?protocol+"//click.oneplus.cn":"net"==domainInfo.domain?protocol+"//click.oneplus.net":protocol+"//click.oneplus.com",win._opq={push:function(e){(isFunction(e[0])?e[0]:win._opq[e[0]])(e.slice(1))},trackPageView:function(){sendData("Access")},trackEvent:function(e){var t={};e.length?t.description=e[e.length-1]:"object"==typeof e&&(t=e),sendData("Click",t)}},sendData("Access"),canUseTiming()&&sendPageTime(),clickEventInit(),function(){function e(e){var t,n="JsError";if(e.filename)t={stackMsg:e.error&&e.error.stack||"",errMsg:e.message||"",filename:e.filename||"",lineno:e.lineno||"",promiseErr:e.reason||""};else{n="ResourceError";var o=e.target?e.target:e.srcElement,r=o&&o.getAttribute&&(o.getAttribute("src")||o.getAttribute("href"));r&&isStaticsDomain(getDomainByUrl(r))&&(t={filename:r})}t&&sendData(n,t)}win.addEventListener?(win.addEventListener("error",e,!0),win.addEventListener("unhandledrejection",e)):win.attachEvent&&(win.attachEvent("error",e),win.attachEvent("unhandledrejection",e))}()}(window,document);